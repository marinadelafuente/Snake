"use strict";const popUpBtn=document.querySelector(".btn__pop-up"),popUpClose=document.querySelector(".btn__pop-up__close"),popUp=document.querySelector(".pop-up"),grid=document.querySelector(".grid"),startBtn=document.querySelector(".btn__start"),resetBtn=document.querySelector(".btn__reset");let scoreDisplay=document.querySelector(".score");const gridWidth=10;let intervalId,eatSound,gameOverSound,currentIndex=0,appleIndex=0,squares=[],currentSnake=[2,1,0],direction=1,score=0,intervalTime=1e3;const openPopUp=()=>{popUp.style.display="block"},closePopUp=e=>{(e.target.classList.contains("pop-up")||e.target===popUpClose)&&(popUp.style.display="none")},createGrid=()=>{for(let e=0;e<100;e++){const e=document.createElement("div");e.classList.add("square"),grid.appendChild(e),squares.push(e)}};createGrid();const paintSnake=()=>{currentSnake.forEach(e=>{squares[e].classList.add("snake"),squares[currentSnake[0]].classList.replace("snake","snake__head")})};function sound(e){this.sound=document.createElement("audio"),this.sound.src=e,this.sound.setAttribute("preload","auto"),this.sound.setAttribute("controls","none"),this.sound.style.display="none",document.body.appendChild(this.sound),this.play=function(){this.sound.play()},this.stop=function(){this.sound.pause()}}paintSnake();const startGame=()=>{generateApples(),intervalId=setInterval(moveSnake,intervalTime),startBtn.style.pointerEvents="none",startBtn.classList.replace("btn","unavailable")},moveSnake=()=>{if(currentSnake[0]+10>=100&&10===direction||currentSnake[0]%10==9&&1===direction||currentSnake[0]%10==0&&-1===direction||currentSnake[0]-10<0&&-10===direction||squares[currentSnake[0]+direction].classList.contains("snake"))return clearInterval(intervalId),currentSnake.forEach(e=>{squares[e].classList.add("game-over"),gameOverSound=new sound("./assets/sounds/game-over.wav"),gameOverSound.play()}),setTimeout(reset,2e3);let e=currentSnake.pop();squares[e].classList.remove("snake"),squares[e].classList.remove("snake__head"),currentSnake.unshift(currentSnake[0]+direction);let t=currentSnake[0];afterAppleEating(e),currentSnake.forEach(e=>{squares[e].classList.add("snake"),squares[e].classList.remove("snake__head","snake__head-down","snake__head-left")}),10===direction?squares[t].classList.replace("snake","snake__head-down"):-1===direction?squares[t].classList.replace("snake","snake__head-left"):squares[t].classList.replace("snake","snake__head")},afterAppleEating=e=>{squares[currentSnake[0]].classList.contains("apple")&&(eatSound=new sound("./assets/sounds/eatSound.ogg"),eatSound.play(),squares[appleIndex].classList.remove("apple"),squares[e].classList.add("snake"),currentSnake.push(e),generateApples(),score++,scoreDisplay.textContent=score,clearInterval(intervalId),intervalTime*=.9,intervalId=setInterval(moveSnake,intervalTime))},generateApples=()=>{do{appleIndex=Math.floor(Math.random()*squares.length)}while(squares[appleIndex].classList.contains("snake"));squares[appleIndex].classList.add("apple")},controlMove=e=>{squares[currentIndex].classList.remove("snake"),38===e.keyCode?direction=-10:40===e.keyCode?direction=10:37===e.keyCode?direction=-1:39===e.keyCode&&(direction=1)},reset=()=>{currentSnake.forEach(e=>{squares[e].classList.remove("snake","snake__head","snake__head-down","snake__head-left","game-over")}),squares[appleIndex].classList.remove("apple"),startBtn.style.pointerEvents="auto",startBtn.classList.replace("unavailable","btn"),currentSnake=[2,1,0],currentIndex=0,paintSnake(),score=0,scoreDisplay.textContent=score,direction=1,intervalTime=1e3},resetAndStop=()=>{clearInterval(intervalId),reset(),clearInterval(intervalId)};popUpBtn.addEventListener("click",openPopUp),popUpClose.addEventListener("click",closePopUp),document.addEventListener("keyup",controlMove),startBtn.addEventListener("click",startGame),resetBtn.addEventListener("click",resetAndStop);